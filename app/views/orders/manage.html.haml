= content_for :page_title do
  Request Manager
  = link_to "Place a Request", new_request_path, class: "btn btn-default btn-mini"

- if current_user.admin?
  = render partial: "partials/admin_country_select"
  %hr

- if active_country?
  = render partial: "table", locals: { label: "Past Due Requests", rows: @past_due,  table: "request_table", page_param: "past_due_page" }
  = render partial: "table", locals: { label: "Pending Requests",  rows: @pending,   table: "request_table", page_param: "pending_page" }

  .btn-group#archive-selector{ style: "display:none" }
    - %w(unarchived all archived).each do |t|
      - klass = t == (params[:responses]||"unarchived") ? "btn-primary" : "btn-default"
      %button.btn{ "class" => klass, "name" => t}= t.capitalize
  = render partial: "table", locals: { label: "Response Tracker",  rows: @responses, table: "response_table", page_param: "response_page" }

:javascript
  $(function(){
    // Make rows clickable
    $("tr[data-link]").click(function() { window.location = $(this).data("link"); });

    // Hack together an archive status selector pseudo-form
    var sel = $("#archive-selector");
    sel.show();
    sel.find("button").click(function(){
      window.location = window.location.pathname + "?responses=" + $(this).attr("name") + "#archive-selector";
    });
  });
